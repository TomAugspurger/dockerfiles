
#include "xgb-dev"

ARG arch=35;50;52;60;61
#ifndef XGB_COMMIT
#define XGB_COMMIT 998ac6e27107af6d5e73022f1bcbbf5e5dd10d72
#endif
ARG xgCommit=XGB_COMMIT

#ifndef XGB_REPO
#define XGB_REPO "teju85"
#endif

#define XGB_LINK "https://github.com/"XGB_REPO"/xgboost"

RUN git config --global http.sslVerify false && \\
    git clone --recursive XGB_LINK && \\
    cd xgboost && \\
    git reset --hard $xgCommit

ENV XG_COMMIT_ID $xgCommit

RUN cd xgboost && \\
    mkdir build && \\
    cd build && \\
    cmake .. -DGPU_COMPUTE_VER=$arch -DUSE_CUDA=ON && \\
    make -j3 && \\
    cd ../python-package && \\
    python setup.py install
